"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = extract;

var _ora = _interopRequireDefault(require("ora"));

var _babel = _interopRequireDefault(require("./babel"));

var DEFAULT_EXTRACTORS = [_babel.default];

function extract(filename, targetPath, options) {
  var _options$extractors;

  var extractorsToExtract = (_options$extractors = options.extractors) !== null && _options$extractors !== void 0 ? _options$extractors : DEFAULT_EXTRACTORS;
  return extractorsToExtract.some(function (e) {
    var ext = e;

    if (typeof e === "string") {
      // in case of the user using require.resolve in their extractors, we require that module
      ext = require(e);
    }

    if (ext.default) {
      ext = ext.default;
    }

    if (!ext.match(filename)) return false;
    var spinner;
    if (options.verbose) spinner = (0, _ora.default)().start(filename);

    try {
      ext.extract(filename, targetPath, options);
    } catch (e) {
      if (options.verbose && spinner) {
        spinner.fail(e.message);
      } else {
        console.error("Cannot process file ".concat(e.message));
      }

      return true;
    }

    if (options.verbose && spinner) spinner.succeed();
    return true;
  });
}